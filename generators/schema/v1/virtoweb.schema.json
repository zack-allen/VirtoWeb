{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/virtoweb.schema.json",
  "title": "VirtoWeb Project Schema v1",
  "description": "Unified project schema for VirtoWeb: defines pages, routes, components, layouts, forms, assets, metadata and generator options.",
  "type": "object",
  "required": ["project"],
  "properties": {
    "project": {
      "type": "object",
      "required": ["id","title","version"],
      "properties": {
  "id": {"type": "string", "pattern": "^[a-zA-Z0-9_-]+$"},
        "title": {"type": "string"},
        "description": {"type": "string"},
        "version": {"type": "string"},
        "author": {"type": "string"},
        "basePath": {"type": "string", "description": "Optional base path for routes, e.g. /blog"}
      },
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {"type": ["string","number","boolean","object","array","null"]}
      },
      "additionalProperties": false
    },
    "assets": {
      "type": "array",
      "description": "Static assets (images, fonts, styles) to include in the generated project",
      "items": {
        "type": "object",
        "required": ["src","dest"],
        "properties": {
          "src": {"type": "string"},
          "dest": {"type": "string"},
          "type": {"type": "string", "enum": ["image","css","js","font","other"]}
        },
        "additionalProperties": false
      }
    },
    "layouts": {
      "type": "array",
      "description": "Reusable layouts defining regions and template references",
      "items": {
        "type": "object",
        "required": ["id","template"],
        "properties": {
          "id": {"type": "string"},
          "title": {"type": "string"},
          "template": {"type": "string", "description": "Template name or path used by backends"},
          "regions": {
            "type": "array",
            "items": {"type": "string"}
          },
          "props": {
            "type": "object",
            "additionalProperties": true
          },
          "default": {"type": "boolean"}
        },
        "additionalProperties": false
      }
    },
    "components": {
      "type": "array",
      "description": "Reusable components (server-rendered or template snippets)",
      "items": {
        "type": "object",
        "required": ["id","type"],
        "properties": {
          "id": {"type": "string"},
          "type": {"type": "string", "enum": ["static","dynamic","form","nav","list","hero"]},
          "template": {"type": "string"},
          "props": {"type": "object", "additionalProperties": true},
          "children": {"type": "array", "items": {"$ref": "#/properties/components/items"}}
        },
        "additionalProperties": false
      }
    },
    "pages": {
      "type": "array",
      "description": "Pages that map to routes. Each page references a layout and supplies region content." ,
      "items": {
        "type": "object",
        "required": ["id","route","title","layout"],
        "properties": {
          "id": {"type": "string"},
          "route": {"type": "string"},
          "title": {"type": "string"},
          "description": {"type": "string"},
          "layout": {"type": "string"},
          "meta": {"type": "object", "additionalProperties": true},
          "regions": {
            "type": "object",
            "description": "Map regionName -> array of component instances",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["component"],
                "properties": {
                  "component": {"type": "string"},
                  "props": {"type": "object", "additionalProperties": true}
                },
                "additionalProperties": false
              }
            }
          },
          "data": {"type": ["object","array","null"], "description": "Optional data payload for server-side rendering"}
        },
        "additionalProperties": false
      }
    },
    "forms": {
      "type": "array",
      "description": "Form definitions that can be referenced by components",
      "items": {
        "type": "object",
        "required": ["id","action","method","fields"],
        "properties": {
          "id": {"type": "string"},
          "action": {"type": "string"},
          "method": {"type": "string", "enum": ["GET","POST"]},
          "csrf": {"type": "boolean"},
          "fields": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name","type"],
              "properties": {
                "name": {"type": "string"},
                "type": {"type": "string"},
                "label": {"type": "string"},
                "placeholder": {"type": "string"},
                "required": {"type": "boolean"},
                "validation": {"type": "object", "additionalProperties": true}
              },
              "additionalProperties": false
            }
          }
        },
        "additionalProperties": false
      }
    },
    "generator": {
      "type": "object",
      "properties": {
        "language": {"type": "string", "enum": ["php","node","python","static"]},
        "outputDir": {"type": "string"},
        "templateVariant": {"type": "string"},
        "options": {"type": "object", "additionalProperties": true}
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
